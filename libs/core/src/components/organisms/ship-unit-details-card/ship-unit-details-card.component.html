<!-- 9fbef606107a605d69c0edbcd8029e5d_SYMPHONY -->

<lib-data-table
  [showTable]="shipUnitDetailsColumnLabels"
  tableTitle="{{ 'dpf_l3_shptInfo_shpUnitDetailsCrd' | content }}"
  [dataAutomationAttribute]="dataAutomationAttrTable"
  [dataAutomationHeader]="dataAutomationAttrTable + '-header'"
  [dataAutomationTitle]="dataAutomationAttrTable + '-title'"
  [dataAutomationTooltip]="dataAutomationAttrTable + '-tooltip'"
  [displayedColumns]="shipUnitDetailsDisplayedColumns"
  [tableData]="tableData"
  elevationClass="mat-elevation-z0"
  [columnInfo]="shipUnitDetailsColumnLabels"
  paginatorPageSize="5"
  noRecordMessage=" {{ 'lbl_no_item_details' | content }}"
  errorReason="Shipment Details Api Failed"
></lib-data-table>

<ng-template #descriptionFieldTemplate let-columnData="columnData">
  <div
    class="table-cell"
    *ngIf="
      columnData &&
      (columnData.referenceTypes.length ||
        columnData.temperatureDetails.values !== null)
    "
  >
    {{ columnData.description }}
    <div class="table-cell-content">
      <div
        *ngIf="columnData.temperatureDetails[temperatureMin]"
        aria-hidden="true"
        class="hover-link"
        [libPopoverDirective]="popoverTemplateForTemperatureCell"
        popoverPlacement="bottom"
        [attr.data-automation]="dataAutomationAttrTable + '-temp-icon'"
      >
        <div class="temperature">
          <span class="temperature_label">
            {{ "dpf_l3_shptInfo_shpUnitDetailsCrdTmp" | content }}</span
          >
          <i
            class="temperature_icon symphony-icons symphony-icons-snowflake-light"
          >
          </i>
        </div>
      </div>
      <span class="sr-only"
        >{{ ("dpf_l3_shptInfo_shpUnitDetailsCrdTmp" | content) + " " }}
        {{ columnData.temperatureDetails | json }}</span
      >
      <div
        *ngIf="columnData.referenceTypes.length > 0"
        aria-hidden="true"
        class="hover-link"
        [libPopoverDirective]="popoverTemplateForReferencesCell"
        popoverPlacement="bottom"
        [attr.data-automation]="dataAutomationAttrTable + '-ref-icon'"
      >
        <div class="reference">
          <span class="reference_label">
            {{ "dpf_l3_shptInfo_shpUnitDetailsCrdRef" | content }}</span
          >
          <i
            class="reference_icon symphony-icons symphony-icons-arrow-alt-circle-down-regular"
          >
          </i>
        </div>
      </div>
      <span class="sr-only"
        >{{ ("dpf_l3_shptInfo_shpUnitDetailsCrdRef" | content) + " " }}
        <ng-container
          *ngFor="let i of columnData.referenceTypes; let last = last"
        >
          {{ i.referenceType + ":" + i.referenceValue }}
          {{ last ? "" : "," }}
        </ng-container>
      </span>
    </div>
    <ng-template #popoverTemplateForTemperatureCell>
      <ng-container
        *ngTemplateOutlet="
          viewMoreKeyValueTemplate;
          context: {
            colName:
              'dpf_l3_shptInfo_shpUnitDetailsCrdTmp' | content | uppercase,
            columnData: columnData.temperatureDetails
          }
        "
      ></ng-container>
    </ng-template>
    <ng-template #popoverTemplateForReferencesCell>
      <ng-container
        *ngTemplateOutlet="
          viewMoreKeyValueTemplate;
          context: {
            colName:
              'dpf_l3_shptInfo_shpUnitDetailsCrdRef' | content | uppercase,
            columnData: columnData.referenceTypes
          }
        "
      ></ng-container>
    </ng-template>
  </div>
</ng-template>

<ng-template
  #viewMoreKeyValueTemplate
  let-columnData="columnData"
  let-colName="colName"
>
  <lib-view-more
    variation="multiKeyValueTooltip"
    [columnData]="columnData"
    [colName]="colName"
  ></lib-view-more>
</ng-template>
