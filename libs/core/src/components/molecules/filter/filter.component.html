<!-- 9fbef606107a605d69c0edbcd8029e5d_SYMPHONY -->
<button
  class="filters-cta"
  [class.filterApplied]="isFilterApplied"
  (click)="
    pageAndWidgetLevelCombo
      ? filterButtonClicked.emit(true)
      : toggleFilterSlideout()
  "
  [attr.aria-label]="'lbl_filters' | content"
  [attr.data-automation]="dataAutomationAttribute.barFilterButton"
  [disabled]="disabled"
  *ngIf="showFilterToggleButton"
>
  <i class="symphony-icons symphony-icons-filter" aria-hidden="true"></i>
  <span class="body-5 filter-label">{{ "lbl_filters" | content }}</span>
</button>
<div *ngIf="showFilterSlideOut">
  <div
    class="filters-wrapper"
    [ngClass]="{
      'overlay overlay-left': isMobile,
      bannerVisible: isBannerVisible
    }"
    role="content"
  >
    <div class="filters-header">
      <lib-button
        variation="link-button"
        (clickEvent)="resetFilters($event)"
        [text]="'lbl_clear_all_filters' | content"
        [ariaLabel]="'lbl_clear_all_filters' | content"
        size="sm"
        [attr.data-automation]="dataAutomationAttribute.barClearButton"
      ></lib-button>
      <button
        class="closeBtn"
        [attr.aria-label]="'lbl_close' | content"
        (click)="toggleFilterSlideout(true)"
        [attr.data-automation]="dataAutomationAttribute.barFilterButton"
      >
        <i
          class="symphony-icons symphony-icons-close"
          id="closeIcon"
          aria-hidden="true"
        ></i>
      </button>
    </div>
    <div class="filters-body">
      <form [formGroup]="filtersForm">
        <div
          formArrayName="filtersArray"
          *ngFor="let filter of filtersConfiguration; index as i"
        >
          <div
            *ngIf="
              filter.filterType === filterType.DATE_RANGE &&
              filter?.options?.length
            "
          >
            <lib-date-filter
              [filterConfiguration]="filter"
              [filterForm]="filtersForm.get('filtersArray')['controls'][i]"
              (resetFilter)="resetFilters($event, i)"
            ></lib-date-filter>
          </div>
          <div *ngIf="filter.filterType === filterType.MILESTONE">
            <div
              *ngIf="!filter?.isDataLoaded"
              class="loader"
              [style.height]="'70px'"
            ></div>
            <lib-status-filter
              *ngIf="filter?.isDataLoaded"
              [showCount]="showMultiSelectCount"
              [filterConfiguration]="filter"
              [filterForm]="filtersForm.get('filtersArray')['controls'][i]"
            ></lib-status-filter>
          </div>
          <div
            *ngIf="
              filter.filterType === filterType.STATUS && filter?.options?.length
            "
          >
            <div
              *ngIf="!filter?.isDataLoaded"
              class="loader"
              [style.height]="'70px'"
            ></div>
            <lib-status-filter
              *ngIf="filter?.isDataLoaded"
              [showCount]="showMultiSelectCount"
              [filterConfiguration]="filter"
              [filterForm]="filtersForm.get('filtersArray')['controls'][i]"
            ></lib-status-filter>
          </div>
          <div
            *ngIf="filter.filterType === filterType.SINGLE_SELECT"
            class="filter-select-dropdown"
            [formGroup]="filtersForm.get('filtersArray')['controls'][i]"
          >
            <div
              *ngIf="!filter?.isDataLoaded"
              class="loader"
              [style.height]="'70px'"
            ></div>
            <lib-select
              *ngIf="filter?.isDataLoaded"
              [customStyle]="selectBoxStyle"
              controlName="filterValue"
              className="filter-select"
              [optionLists]="filter?.options"
              [label]="filter?.label | content"
              [getValueFromCMS]="false"
              [placeholder]="filter?.placeholder | content"
              [showPlaceholderAsOption]="filter?.showPlaceholderAsOption"
            >
            </lib-select>
          </div>

          <div
            *ngIf="
              filter.filterType === filterType.MULTI_SELECT &&
              filter?.options?.length
            "
            class="filter-select-dropdown"
            [formGroup]="filtersForm.get('filtersArray')['controls'][i]"
          >
            <div
              *ngIf="!filter?.isDataLoaded"
              class="loader"
              [style.height]="'70px'"
            ></div>
            <lib-select
              *ngIf="filter?.isDataLoaded"
              [model]="
                filtersForm
                  .get('filtersArray')
                  ['controls'][i].get('filterValue')
              "
              [customStyle]="selectBoxStyle"
              [selectAllCheckboxText]="'lbl_multi-select_selectall' | content"
              [initialSelected]="
                filtersForm
                  .get('filtersArray')
                  ['controls'][i].get('filterValue').value
              "
              controlName="filterValue"
              className="filter-multi-select"
              [optionLists]="filter?.options"
              [showColorsInMultiSelect]="false"
              variation="multiple"
              [showSelectAllOption]="true"
              [label]="filter?.label | content"
              [getValueFromCMS]="false"
              [placeholder]="filter?.placeholder | content"
              [selectAllValue]="multiSelectAll"
              [attr.data-automation]="'bar-filter-' + filter?.key"
            >
            </lib-select>
          </div>
          <div *ngIf="filter.filterType === filterType.MULTI_CHECKBOX">
            <lib-multi-checkbox-filter
              [filterConfiguration]="filter"
              [filterForm]="filtersForm.get('filtersArray')['controls'][i]"
            >
            </lib-multi-checkbox-filter>
          </div>
        </div>
      </form>
    </div>
    <div class="filters-footer">
      <lib-button
        [text]="'lbl_apply'"
        color="primary"
        [disabled]="filtersForm?.invalid"
        [fullWidth]="true"
        (clickEvent)="onApplyClick()"
        [ariaLabel]="'lbl_apply' | content"
        [attr.data-automation]="dataAutomationAttribute.barFilterApply"
      ></lib-button>
    </div>
  </div>
</div>
