<!-- 9fbef606107a605d69c0edbcd8029e5d_SYMPHONY -->
<div
  *ngIf="variation === 'multiValueTooltip' && columnData && columnData.length"
>
  <!--Offset is the number of values to be shown in the column followed by +X popover-->
  {{ columnData.slice(0, offset).join(",") }}
  {{ columnData.length > offset ? " ..." : "" }}
  <a
    *ngIf="columnData.length > offset"
    aria-hidden="true"
    class="openPopoverText"
    [libPopoverDirective]="popoverContentTemplate"
    (click)="$event.stopPropagation()"
    (touchstart)="$event.stopPropagation()"
  >
    <span aria-hidden="true">+{{ columnData.length - offset }}</span>
    <span class="sr-only">{{ columnData.slice(offset).join(",") }}</span>
  </a>
  <ng-template #popoverContentTemplate>
    <div class="popover">
      <div class="popover-header body4">{{ colName }}</div>
      <div class="popover-body">
        <table class="body4 popover-table">
          <tr class="sr-only">
            <th scope="col"></th>
          </tr>
          <tr
            *ngFor="
              let item of columnData.slice(
                0,
                columnData.length / popoverColumns +
                  (columnData.length % popoverColumns) >
                  popoverMaxItems / popoverColumns +
                    (popoverMaxItems % popoverColumns)
                  ? popoverMaxItems / popoverColumns +
                      (popoverMaxItems % popoverColumns)
                  : columnData.length / popoverColumns +
                      (columnData.length % popoverColumns)
              );
              let i = index
            "
          >
            <td
              *ngFor="
                let value of columnData.slice(
                  i * popoverColumns,
                  popoverColumns * (i + 1)
                );
                let j = index
              "
            >
              <span *ngIf="i * popoverColumns + j <= popoverMaxItems - 1">{{
                value
              }}</span>
              <span *ngIf="i * popoverColumns + j > popoverMaxItems - 1">
                <a
                  role="button"
                  class="view-more"
                  libModalDirective
                  [modalTemplate]="modalTemplate"
                  >{{ "lbl_view_more_link" | content }}</a
                >
              </span>
            </td>
          </tr>
        </table>
      </div>
    </div>
  </ng-template>
  <ng-template #modalTemplate>
    <div role="document">
      <mat-dialog-title>
        <div class="modal-header">
          <div class="modal-header-filler"></div>
          <h1 id="dialog-title" class="title">
            {{ colName }}
          </h1>
          <button
            mat-flat-button
            mat-dialog-close
            aria-label="{{ 'lbl_modal_close_btn_aria' | content }}"
            [color]="'primary'"
            class="img-button"
          >
            <i class="symphony-icons symphony-icons-close"></i>
          </button>
        </div>
      </mat-dialog-title>
      <mat-dialog-content id="dialog-desc">
        <div class="modal-body">
          <table class="body2">
            <tr class="sr-only">
              <th scope="col"></th>
            </tr>
            <tr
              *ngFor="
                let item of columnData.slice(
                  0,
                  columnData.length / modalColumns +
                    (columnData.length % modalColumns)
                );
                let i = index
              "
            >
              <td
                *ngFor="
                  let value of columnData.slice(
                    i * modalColumns,
                    modalColumns * (i + 1)
                  );
                  let j = index
                "
              >
                <span *ngIf="i * modalColumns + j < columnData.length - 1">{{
                  value
                }}</span>
              </td>
            </tr>
          </table>
        </div>
      </mat-dialog-content>
      <mat-dialog-actions>
        <button
          mat-flat-button
          mat-dialog-close
          [color]="'primary'"
          aria-label="{{ 'lbl_confirmation_modal_okCta' | content }}"
          class="ok-button"
        >
          {{ "lbl_confirmation_modal_okCta" | content }}
        </button>
      </mat-dialog-actions>
    </div>
  </ng-template>
</div>

<div
  *ngIf="variation === 'multiKeyValueTooltip'"
  class="popover key-value-popover"
>
  <div class="popover-header body4">{{ colName }}</div>
  <div class="popover-body">
    <div class="popover-body-content" *ngIf="colName === temperature">
      <div class="body4">
        <span class="type text-break">{{
          "dpf_l3_shptInfo_shpUnitDetailsCrdtempMin" | content
        }}</span>
        <span class="value text-break">{{
          columnData.temperatureRangeMin
        }}</span>
      </div>
      <div class="body4">
        <span class="type text-break">{{
          "dpf_l3_shptInfo_shpUnitDetailsCrdtempMax" | content
        }}</span>
        <span class="value text-break">{{
          columnData.temperatureRangeMax
        }}</span>
      </div>
      <div class="body4">
        <span class="type text-break">{{
          "dpf_l3_shptInfo_shpUnitDetailsCrdtempUOM" | content
        }}</span>
        <span class="value text-break">{{
          columnData.temperatureRangeUOM
        }}</span>
      </div>
      <div class="body4">
        <span class="type text-break">{{
          "dpf_l3_shptInfo_shpUnitDetailsCrdtempRnge" | content
        }}</span>
        <span class="value text-break">{{
          columnData.temperatureRangeCode
        }}</span>
      </div>
    </div>
    <div class="popover-body-content" *ngIf="colName === referencesType">
      <div
        *ngFor="let item of columnData.slice(0, referencesLimit); let i = index"
        class="body4"
      >
        <span class="type text-break">{{ item.referenceType }}</span>
        <span class="value text-break">{{ item.referenceValue }}</span>
      </div>
    </div>

    <a
      *ngIf="colName === referencesType && columnData.length > referencesLimit"
      class="view-more body5"
      libModalDirective
      [modalTemplate]="modalTemplateForCell"
      modalClass="symphony-references-modal"
      >{{ "lbl_view_more_link" | content }}</a
    >
    <ng-template #modalTemplateForCell>
      <div role="document">
        <mat-dialog-title>
          <div class="modal-header">
            <div class="modal-header-filler"></div>
            <h1 id="dialog-title" class="title">
              {{ colName }}
            </h1>
            <button
              mat-flat-button
              mat-dialog-close
              attr.aria-label="{{ 'lbl_modal_close_btn_aria' | content }}"
              color="primary"
              class="img-button"
            >
              <i class="symphony-icons symphony-icons-close"></i>
            </button>
          </div>
        </mat-dialog-title>
        <mat-dialog-content id="dialog-desc">
          <div class="modal-body">
            <div class="modal-body-content">
              <div *ngFor="let item of columnData; let i = index" class="body2">
                <span class="type text-break">{{ item.referenceType }} </span>
                <span class="value text-break">{{ item.referenceValue }}</span>
              </div>
            </div>
          </div>
        </mat-dialog-content>
        <mat-dialog-actions>
          <button
            mat-flat-button
            mat-dialog-close
            color="primary"
            attr.aria-label="{{ 'lbl_confirmation_modal_okCta' | content }}"
            class="ok-button"
          >
            {{ "lbl_confirmation_modal_okCta" | content }}
          </button>
        </mat-dialog-actions>
      </div>
    </ng-template>
  </div>
</div>

<div *ngIf="variation === viewMoreVariations.modalVariation">
  {{ columnData.slice(0, offset) }}
  {{ columnData.length > offset ? " ..." : "" }}
  <a
    *ngIf="columnData.length > offset"
    class="view-more-link body5"
    libModalDirective
    [modalTemplate]="modalTemplateForCell"
    modalClass="symphony-view-more-data-modal"
    [attr.data-automation]="dataAutoAttr + '-view-more'"
    >{{ "lbl_view_more_link" | content }}</a
  >
  <ng-template #modalTemplateForCell>
    <div role="document">
      <mat-dialog-title>
        <div class="modal-header">
          <div class="modal-header-filler"></div>
          <h1
            id="dialog-title"
            class="title"
            [attr.data-automation]="dataAutoAttr + '-modal-title'"
          >
            {{ "lbl_shipment_deliveryInstructions" | content }}
          </h1>
          <button
            mat-flat-button
            mat-dialog-close
            attr.aria-label="{{ 'lbl_modal_close_btn_aria' | content }}"
            color="primary"
            class="img-button"
            [attr.data-automation]="dataAutoAttr + '-modal-close-button'"
          >
            <i class="symphony-icons symphony-icons-close"></i>
            <span class="sr-only">{{
              "lbl_modal_close_btn_aria" | content
            }}</span>
          </button>
        </div>
      </mat-dialog-title>
      <mat-dialog-content id="dialog-desc">
        <div class="modal-body">
          <div
            class="modal-body-content"
            [attr.data-automation]="dataAutoAttr + '-modal-description'"
          >
            {{ columnData }}
          </div>
        </div>
      </mat-dialog-content>
      <mat-dialog-actions>
        <button
          mat-flat-button
          mat-dialog-close
          color="primary"
          attr.aria-label="{{ 'lbl_confirmation_modal_okCta' | content }}"
          class="ok-button"
          [attr.data-automation]="dataAutoAttr + '-modal-ok-button'"
        >
          {{ "lbl_confirmation_modal_okCta" | content }}
        </button>
      </mat-dialog-actions>
    </div>
  </ng-template>
</div>
