<!-- 9fbef606107a605d69c0edbcd8029e5d_SYMPHONY -->
<mat-card
  class="app-card"
  class="mat-elevation-z0"
  [ngClass]="className ? className : ''"
  [ngStyle]="customStyle"
>
  <mat-card-header
    *ngIf="title"
    [ngClass]="headerClass"
    [class]="isCardBoxAccordion ? 'collapsible' : ''"
  >
    <mat-card-title [attr.data-automation]="dataAutomationHeader">
      <div class="exception-msg-container">
        <i *ngIf="headericon" [class]="headericon"></i>
        <h3
          tabindex="0"
          [attr.data-automation]="dataAutomationTitle"
          class="h4 card-header"
        >
          {{ title }}
          <ng-container *ngIf="showLearnMoreInTooltip">
            <ng-container
              *ngTemplateOutlet="learnMoreIconTemplate"
            ></ng-container>
          </ng-container>
        </h3>
        <div class="extra-title" *ngIf="extraTitle">
          <div class="label">
            {{ extraTitle.label + " " }}
            <span class="value">
              <ng-container
                *ngTemplateOutlet="
                  extraTitle.template;
                  context: {
                    columnData: extraTitle.value,
                    classes: extraTitle.classes,
                    rowData: null
                  }
                "
              ></ng-container>
            </span>
            <span class="date">{{ " " + extraTitle.date }}</span>
          </div>
        </div>

        <button
          class="tooltip-icon"
          [attr.data-automation]="dataAutomationTooltip"
          [libPopoverDirective]="customTooltipTemplate || tooltipTemplate"
          [closeMenuSubject]="closeMenu"
          popoverType="tooltip"
          popoverPlacement="right"
          *ngIf="showInfoIcon"
          tabindex="0"
        >
          <span class="sr-only">
            {{ "lbl_chart_learn_more" | content }}
          </span>
          <i class="card-icon symphony-icons symphony-icons-info-circle"></i>
        </button>
        <div *ngIf="headerLeftTemplate" class="header-left">
          <ng-container *ngTemplateOutlet="headerLeftTemplate"></ng-container>
        </div>
      </div>

      <lib-expansion-toggle
        *ngIf="isCardBoxAccordion"
        data-automation="activity-feed-ExpCol"
        [expanded]="showContent"
        (expansionToggleClicked)="showContent = !showContent"
      >
      </lib-expansion-toggle>

      <div *ngIf="headerRightTemplate" class="header-right body2">
        <ng-container *ngTemplateOutlet="headerRightTemplate"></ng-container>
      </div>
    </mat-card-title>
    <mat-card-subtitle *ngIf="subtitle">{{ subtitle }}</mat-card-subtitle>
  </mat-card-header>
  <div
    [class.hideContent]="
      isCardBoxAccordion ? (showContent ? false : true) : false
    "
  >
    <mat-card-content [ngClass]="contentClass">
      <div class="body5">
        <ng-content></ng-content>
      </div>
    </mat-card-content>
  </div>
  <mat-card-footer *ngIf="footer" class="app-card_text">
    {{ footer }}
  </mat-card-footer>
</mat-card>
<ng-template #tooltipTemplate>
  <div class="tooltip-text">
    {{ infoTooltipLabel | content }}
  </div>
  <button (click)="navigateToReportsSection()" class="tooltip-link">
    {{ "lbl_info_tooltip_records_link" | content }}
    <i class="symphony-icons symphony-icons-external-link"></i>
  </button>
</ng-template>

<ng-template #learnMoreIconTemplate>
  <span class="learn-more-icon-wrapper">
    <button
      *ngIf="isDesktopDevice"
      class="learn-more-info-icon"
      [libPopoverDirective]="learnMorePopoverTemplate"
      popoverPlacement="top"
      (click)="learnMoreClick.emit()"
      popoverType="tooltip"
      [attr.data-automation]="dataAutomationHeader + '-learn-more'"
    >
      <span class="sr-only">
        {{ "lbl_chart_learn_more" | content }}
      </span>
      <i class="card-icon symphony-icons symphony-icons-info-circle"></i>
    </button>
    <button
      *ngIf="!isDesktopDevice"
      class="learn-more-info-icon"
      (click)="learnMoreClick.emit()"
      [attr.data-automation]="dataAutomationHeader + '-learn-more'"
    >
      <i class="card-icon symphony-icons symphony-icons-info-circle"></i>
    </button>
  </span>
</ng-template>

<ng-template #learnMorePopoverTemplate>
  <button (click)="learnMoreClick.emit()" class="learn-more-link">
    {{ "lbl_chart_learn_more" | content }}
  </button>
</ng-template>
